resources:
  methods:
    T3DD_Backend_AllControllerActions: 'within(TYPO3\Flow\Mvc\Controller\AbstractController) && method(public .*->(?!initialize).*Action())'
    T3DD_Backend_PublicFrontendAccess: 'method(T3DD\Frontend\Controller\FrontendController->serveAction()) || method(T3DD\Login\Controller\AuthenticationController->(login|authenticate|callback|status)Action()) || method(TYPO3\Flow\Security\Authentication\Controller\AbstractAuthenticationController->authenticateAction()) || method(T3DD\Backend\Controller\SessionController->(list|show)Action()) || method(Netlogix\Crud\Controller\RestController->errorAction())'
    T3DD_Backend_Participant: 'method(T3DD\Backend\Controller\ParticipantController->(show|create)Action())'
    T3DD_Backend_Session: 'method(T3DD\Backend\Controller\SessionController->(create|update|delete)Action())'
    T3DD_Backend_Vote: 'method(T3DD\Backend\Controller\VoteController->(myVotes|create|delete)Action())'


roles:
  Authenticated: [AuthenticatedUser]
  Participant: [Authenticated]
  Administrator: [AuthenticatedUser]

acls:
  Everybody:
    methods:
      T3DD_Backend_PublicFrontendAccess: GRANT
  Authenticated:
    methods:
      T3DD_Backend_Participant: GRANT
      T3DD_Backend_Session: GRANT
  Administrator:
    methods:
      T3DD_Backend_AllControllerActions: GRANT
