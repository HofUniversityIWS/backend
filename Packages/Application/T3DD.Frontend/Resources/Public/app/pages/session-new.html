<link rel="import" href="../elements/site-form/site-form.html">
<link rel="import" href="../bower_components/marked-element/marked-element.html">
<link rel="import" href="../bower_components/paper-button/paper-button.html">
<link rel="import" href="../bower_components/paper-input/paper-input.html">
<link rel="import" href="../bower_components/paper-input/paper-autogrow-textarea.html">
<link rel="import" href="../bower_components/paper-radio-group/paper-radio-group.html">
<link rel="import" href="../elements/site-overlay-spinner/site-overlay-spinner.html">

<polymer-element name="session-new">
	<template>
		<style>
			:host {
				display: block;
			}

			.session {
				padding: 20px;
				background: #fff;
			}

			paper-autogrow-textarea {
				width: 100%;
				margin-bottom: 30px;
			}
		</style>

		<paper-shadow z="1">
			<div class="session">
				<h2>Register a new session</h2>
				<div horizontal layout>
					<form id="form" is="site-form" action="/sessions" method="post" enctype="application/json" headers='{"Accept": "application/json"}' flex>
						<paper-input-decorator label="Session title" floatingLabel error="Enter a session title!">
							<input name="title" value="{{formData.title}}" is="core-input" required>
						</paper-input-decorator>
						<paper-input-decorator label="Describe your session" floatingLabel error="Enter a session description!">
							<paper-autogrow-textarea>
								<textarea name="description" placeholder="Describe your session" value="{{formData.description}}" required></textarea>
							</paper-autogrow-textarea>
						</paper-input-decorator>

						<paper-button on-click="{{submit}}">
							<core-icon icon="check"></core-icon>
							Register
						</paper-button>
						<site-overlay-spinner active="{{$.form.isSubmitting}}"></site-overlay-spinner>
					</form>
					<div class="preview" flex>
						<h3>{{formData.title}}</h3>
						<marked-element text="{{formData.description}}"></marked-element>
					</div>
				</div>
			</div>
		</paper-shadow>
	</template>
	<script>
		(function () {
			'use strict';
			Polymer({
				formData: {
					title: '',
					description: '',
					timestamp: new Date().getTime()
				},
				ready: function() {
					this.$.form.addEventListener('submitted', this.$.form.changePageToResource);
				},
				submit: function() {
					this.$.form.submit();
				}
			});

		})();
	</script>
</polymer-element>
